@using DataAccess.ViewModel;
@model AdminDashboard
<link rel="stylesheet" href="~/css/AdminSite.css" asp-append-version="true" />
<div class="container mt-2">
    <div class="justify-content-between d-flex container-fluid mb-2 position-relative ">
        <div class="">
            <h3> User Access</h3>
        </div>
        <div>
            <a asp-action="Dashboard" class="btn btn-outline-info" asp-controller="Admin"> ❮ Back </a>
        </div>
    </div>
    <div class="d-flex justify-content-between border-0 shadow p-4 mb-5 rounded">
        <div>

            <select class="form-select form-control ms-3 filterphysician" aria-label="Default select example">
                @if (Model.Regions != null)
                {
                    <option value="0" selected>All</option>
                    @foreach (var item in Model.Regions)
                    {

                        <option value="@item.Regionid">@item.Name</option>

                    }
                }

            </select>
        </div>
        <div class="d-flex">
            <button class="btn btn-info mx-2" id="savechangesbtn" onclick="saveChanges()" style="display:block">
                <span>Save Changes</span>
            </button>
            <a class="btn btn-info mx-2">
                <span>Create Provider Account</span>
            </a>
        </div>
    </div>
    <div class="w-100 my-3"></div>
    <table class="table table-hover table-responsive" style="height:75px; text-align:match-parent">
        <thead>
            <tr class="table-secondary">
                <td>Account type</td>
                <td>Accpount Poc</td>
                <td>Phone</td>
                <td>Status</td>
                <td>Open Requests</td>
                <td>Actions</td>
            </tr>
        </thead>
        <tbody>
            @if (Model != null)
            {
                @foreach (var items in Model.userAccessModels)
                {
                    <tr>
                        

                        <td>
                            @items.AccountType
                        </td>
                        <td>
                            @items.AccountPOC
                        </td>
                        <td>
                            @items.PhoneNumber
                        </td>
                        <td>
                            @items.status
                        </td>
                        <td>
                           
                            <button class="btn btn-outline-info tablink" >Edit</button>
                        </td>
                    </tr>

                }
            }


        </tbody>
    </table>
</div>
<script>

    //function showchanges()
    //{

    //    var saveBtn = document.getElementById("savechangesbtn");
    //    saveBtn.style.display = "block";


    //}
    function saveChanges() {
        var checkboxes = document.querySelectorAll('input[type="checkbox"]');
        var dataToSend = [];

        checkboxes.forEach(function (checkbox) {
            var physicianid = checkbox.getAttribute('data-physician-id');
            var checkbox = checkbox.checked;
            dataToSend.push({ physicianid: physicianid, checkbox: checkbox });
        });


        console.log(dataToSend);
        $.ajax({
            type: 'POST',
            url: 'Admin/PostMyProfile',
            data: { dataToSend: dataToSend },

            success: function (data) {
                console.log("Data saved successfully.");

                console.log(data);
            },
            error: function (xhr, status, error) {
                console.log("Error saving data: " + error + ". Status: " + status);
                console.log(xhr.responseText);
            }
        });
    }


        //function saveChanges() {
        //    const checkboxes = Array.from(document.querySelectorAll('input[type="checkbox"]:checked'));
        //    const dataToSend = checkboxes.map(checkbox => {
        //        return {
        //            //Id: checkbox.getAttribute('data-id'),
        //            IsChecked: checkbox.checked
        //        }
        //    });

        //    $.ajax({
        //        type: "POST",
        //        url: 'Admin/PostProviderData',
        //        data: JSON.stringify(dataToSend), // Convert the data to a JSON string
        //        contentType: "application/json",
        //        dataType: "json",
        //        success: function (response) {
        //            console.log(response);
        //        },
        //        error: function (xhr, textStatus, error) {
        //            console.log(error.toString());
        //        }
        //    });
        //}

</script>

