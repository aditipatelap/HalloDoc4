@using DataAccess.ViewModel;
@model AdminDashboard
<link rel="stylesheet" href="~/css/AdminSite.css" asp-append-version="true" />
<div class="container mt-2">
    <div class="justify-content-between d-flex container-fluid mb-2 position-relative ">
        <div class="">
            <h3> User Access</h3>
        </div>
        <div>
            <a asp-action="Dashboard" class="btn btn-outline-info" asp-controller="Admin"> ❮ Back </a>
        </div>
    </div>
    <div class="d-flex justify-content-between border-0 shadow p-4 mb-5 rounded">
        <div>

            <select class="form-select form-control ms-3 filterphysician" aria-label="Default select example">
                @if (Model.Regions != null)
                {
                    <option value="0" selected>All</option>
                    @foreach (var item in Model.Regions)
                    {

                        <option value="@item.Regionid">@item.Name</option>

                    }
                }

            </select>
        </div>
        <div class="d-flex">
            <button class="btn btn-info mx-2" id="savechangesbtn" onclick="saveChanges()" style="display:block">
                <span>Save Changes</span>
            </button>
            <a class="btn btn-info mx-2">
                <span>Create Provider Account</span>
            </a>
        </div>
    </div>
    <div class="w-100 my-3"></div>
    <table class="table table-hover table-responsive" style="height:75px; text-align:match-parent">
        <thead>
            <tr class="table-secondary">
                <td>Account type</td>
                <td>Accpount Poc</td>
                <td>Phone</td>
                <td>Status</td>
                <td>Open Requests</td>
                <td>Actions</td>
            </tr>
        </thead>
        <tbody>
            @if (Model != null)
            {
                @foreach (var items in Model.userAccessModels)
                {
                    <tr>
                        

                        <td>
                            @items.AccountType
                        </td>
                        <td>
                            @items.AccountPOC
                        </td>
                        <td>
                            @items.PhoneNumber
                        </td>
                        <td>
                            @items.status
                        </td>
                        <td>
                           
                        </td>
                        <td>
                           
                            <button class="btn btn-outline-info openEditAccess" data-accountypeid="@items.accounttypeid" data-aspnetuserid="@items.aspnetuserid">Edit</button>
                        </td>
                    </tr>

                }
            }


        </tbody>
    </table>
</div>
<script>
    $('.openEditAccess').click(function ()
    {
        var accounttypeid = $(this).data('accountypeid');
        var aspnetuserid=$(this).data('aspnetuserid');
        console.log(accounttypeid);
        $.ajax({
            url: "/Admin/OpenEditAccess",
            method: "POST",
            data: { accounttypeid: accounttypeid, aspnetuserid: aspnetuserid },
            success: function (result) {
                $("#TabContent").html(result);
                // $('#accounttype').val(0);
                // $('#rolename').val('');
                // $('.check_menu:checked').prop('checked', false);
                // form.classlist.remove('was-validated');
                toastr.success("Role Edited successfully!");
            },
            error: function () {
                toastr.error("Error while Create Role");
            }
        });

    });
    
</script>

