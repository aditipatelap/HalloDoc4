@using DataAccess.ViewModel;
@model AdminDashboard
@Html.Partial("DashboardHeader")
<div class="row gx-4 m-4 p-3">
    <div class="col-lg-2 ">
        <button type="button" class="w-100 btn  newbtn text-start" data-btn="NewPartial" data-id="1">

            <i class="fa-solid fa-plus "></i> <span class="fw-bolder">New</span>
            <p class="fw-bold fs-3">@*@ViewBag.Request[0]*@ @Model.newcount</p>

        </button>
    </div>
    <div class="col-lg-2">
        <button type="button" class="w-100 btn    pendingbtn text-start " data-btn="PendingPartial" data-id="2">
            <i class="fa-solid fa-user"></i> <span class="fw-bolder">Pending</span>
            <p class="fw-bold fs-3"> @Model.pendingcount</p>

        </button>

    </div>
    <div class="col-lg-2 ">
        <button type="button" class=" w-100 btn  activebtn text-start border border-success " data-btn="ActivePartial" data-id="3">
            <i class="far fa-check-circle"></i> <span class="fw-bolder">ACTIVE</span>
            <p class="fw-bold fs-3">@Model.activecount</p>

        </button>
    </div>
    <div class="col-lg-2 ">
        <button type="button" class="w-100 btn concludebtn text-start" data-btn="ConcludePartial" data-id="6">
            <i class="bi bi-arrow-clockwise"></i> <span class="fw-bolder">CONCLUDE</span>
            <p class="fw-bold fs-3">@Model.concludecount</p>

        </button>
    </div>
    <div class="col-lg-2">
        <button type="button" class="w-100 btn  toclosebtn  text-start" data-btn="ToClosePartial" data-id="5">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-alarm-fill" viewBox="0 0 16 16">
                <path d="M6 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1H9v1.07a7.001 7.001 0 0 1 3.274 12.474l.601.602a.5.5 0 0 1-.707.708l-.746-.746A6.97 6.97 0 0 1 8 16a6.97 6.97 0 0 1-3.422-.892l-.746.746a.5.5 0 0 1-.707-.708l.602-.602A7.001 7.001 0 0 1 7 2.07V1h-.5A.5.5 0 0 1 6 .5m2.5 5a.5.5 0 0 0-1 0v3.362l-1.429 2.38a.5.5 0 1 0 .858.515l1.5-2.5A.5.5 0 0 0 8.5 9zM.86 5.387A2.5 2.5 0 1 1 4.387 1.86 8.04 8.04 0 0 0 .86 5.387M11.613 1.86a2.5 2.5 0 1 1 3.527 3.527 8.04 8.04 0 0 0-3.527-3.527" />
            </svg> <span class="fw-bolder">TO CLOSE</span>
            <p class="fw-bold fs-3">@Model.toclosecount</p>

        </button>
    </div>
    <div class="col-lg-2">

        <button type="button" class="w-100 btn rounded unpaidbtn text-start" data-btn="UnpaidPartial" data-id="9">
            <i class="bi bi-currency-dollar"></i> <span class="fw-bolder">UNPAID</span>
            <p class="fw-bold fs-3">@Model.unpaidcount</p>

        </button>
    </div>
</div>
<div class="d-flex d-flex justify-content-between m-3 p-3 ">
    <div>
        <span class="fw-bolder fs-4 ">Patients</span>
        <span>(new)</span>

    </div>
    <div class="">
        <button type="button" class="btn btn-info text-white"><i class="bi bi-send"></i><span class="ms-2">Send Link</span></button>
        <button type="button" class="btn btn-info text-white"><i class="bi bi-journal-text"></i><span class="ms-2">Create Requests</span></button>
        <button type="button" class="btn btn-info text-white"><i class="bi bi-reply"></i><span class="ms-2">Export</span></button>
        <button type="button" class="btn btn-info text-white"><i class="bi bi-reply-all"></i><span class="ms-2">Export All</span></button>
        <button type="button" class="btn btn-info text-white"><i class="bi bi-person"></i><span class="ms-2">Request DTY Support</span></button>
    </div>
</div>



<div class="d-flex justify-content-between m-3 p-3 bg-white">
    <div class="d-flex">
        <div class="input-group">
            <input type="text" class="form-control" id="searchInput" placeholder="Search...">
            <span class="input-group-append">
                <button class=" btn-outline-secondary  " id="searchButton" type="button">
                    <i class="fa fa-search"></i>
                </button>
            </span>
        </div>


        @*  <i class="searchicon bi bi-search"></i> <input type="text" class="form-control" placeholder="Search...">*@



        <select class="form-select form-control ms-3" aria-label="Default select example">
            <option selected>All Regions</option>
            <option value="1">One</option>
            <option value="2">Two</option>
            <option value="3">Three</option>
        </select>
    </div>
    <div>
        <button type="button" class="btn btn-outline-secondary">All</button>
        <button class="searchrequest" data-btn="1">  <span class=" ms-2 patientdot  " id="dot"></span> <span>Patient</span></button>
        <button class="searchrequest" data-btn="2">  <span class="ms-2 familydot" id="dot"></span><span>Family/Friend</span></button>
        <button class="searchrequest" data-btn="3"><span class="ms-2 businessdot" id="dot"></span><span>Business</span></button>
        <button class="searchrequest" data-btn="4"> <span class="ms-2 condot" id="dot"></span><span>Concierge</span></button>

    </div>
</div>







<div id="btnContent">
    <div class="modelbody">
    </div>
</div>



        <div id="btnContent">
    <div id="myModalContainer">

    </div>
        </div>
    <script>
        var statusidglobal;
        var btnnameglobal;
        $(document).ready(function () {

            console.log("Document ready");
       
            // Set the default partial view to load
            var defaultPartial = '/Admin/_NewPartial';

            // Make an AJAX request to get the default partial view content and set up click event handling
            $.ajax({
                url: defaultPartial,
                method: 'GET',
                success: function (data) {
                    // Replace the content of the btnContent div with the retrieved partial view
                    $("#btnContent").html(data);

                    // Handle click events on buttons
                    $(document).on("click", ".btn", function () {
                        var btnName = $(this).data("btn");
                        btnnameglobal=btnName;
                        console.log("Button clicked: " + btnnameglobal);
                    

                        var statusid = $(this).data("id");
                        statusidglobal = statusid;
                        console.log("Button clicked: " + statusidglobal);
                        // Make an AJAX request to get the partial view content

                        $.ajax({
                            url: '@Url.Action("GetPartialView", "Admin")',
                            //url: '/Admin/GetPartialView?btn=' + btnName,
                            method: 'GET',
                            data: { btnName: btnName, statusid: statusid },
                            success: function (data) {
                                console.log("AJAX success");
                                // Replace the content of the btnContent div with the retrieved partial view
                                $("#btnContent").html(data);
                                
                            },
                            error: function () {
                                console.error('Error fetching partial view.');
                            }
                        });
                    });
                },
                error: function () {
                    console.error('Error fetching default partial view.');
                }
            });
   


    
        });

        document.getElementById('searchButton').addEventListener('click', handleSearchClick);
        document.getElementById('searchButton').addEventListener('click', handleSearchClick);
            function handleSearchClick() {
        
            // Get the value from the search input
            var searchValue = document.getElementById('searchInput').value;
            console.log(searchValue);
            console.log(statusidglobal);
            console.log(btnnameglobal);
            // Perform the AJAX request
        
            $.ajax({
                type: "GET",
                // url: "/Admin/GetPartialView?searchValue=" + searchValue,
                url: '@Url.Action("GetPartialView", "Admin")',
                data: { searchValue: searchValue, statusid: statusidglobal, btnName: btnnameglobal },
                success: function (data) {
                    console.log("AJAX success");
                    // Update the table body with the filtered data
                    $("#btnContent").html(data);
                    //location.reload();
                },
            
                error: function (error) {
                    console.log("Error:", error);
                }
            });
        
        }
    

    </script>
